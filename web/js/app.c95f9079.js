(function(){"use strict";var e={6529:function(e,t,n){var a=n(9242),s=n(3396),o=n(4870),r=n.p+"img/sponsor_wx.8a76a009.png";const i=e=>((0,s.dD)("data-v-3a506611"),e=e(),(0,s.Cn)(),e),l={class:"rich_content"},c=i((()=>(0,s._)("div",{id:"donate-overlay",style:{position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%","background-color":"rgba(0,0,0,.7)","z-index":"2001"}},null,-1))),d={id:"donate-dialog-div",class:"donate-dialog",style:{width:"400px","z-index":"2002"}},u=i((()=>(0,s._)("div",{class:"d-header"},"服务器资源有限，大佬赞助点吧！",-1))),p=i((()=>(0,s._)("div",{class:"d-content"},[(0,s._)("div",{class:"d-message",style:{"padding-top":"8px",color:"#646566"}},[(0,s._)("img",{style:{width:"300px",padding:"15px 0px"},src:r})])],-1))),m={class:"d-footer"};function g(e,t,n,a,o,r){return(0,s.wg)(),(0,s.iD)("div",l,[c,(0,s._)("div",d,[u,p,(0,s._)("div",m,[(0,s._)("div",{onClick:t[0]||(t[0]=(...e)=>a.closeDonateDialog&&a.closeDonateDialog(...e)),class:"d-text"},"微信已扫")])])])}var f={name:"DonateDialog",setup(e,{emit:t}){const n=()=>{t("closeDonate")};return{closeDonateDialog:n}}},h=n(89);const v=(0,h.Z)(f,[["render",g],["__scopeId","data-v-3a506611"]]);var w=v;const _=e=>((0,s.dD)("data-v-30fbfef8"),e=e(),(0,s.Cn)(),e),y=_((()=>(0,s._)("strong",null,"File.SKI",-1))),b=_((()=>(0,s._)("span",null," Support its development! ",-1))),I=_((()=>(0,s._)("p",{class:"footer-p byline"},[(0,s._)("span",null,"2023 © File.Ski "),(0,s._)("span"),(0,s._)("span",null,"&"),(0,s._)("span"),(0,s._)("span",null," Powered by"),(0,s._)("span"),(0,s._)("a",{href:"https://www.haoba.cc",target:"_blank"}," 咸菜拌白饭")],-1)));var k={__name:"Footer",setup(e){const t=(0,o.iH)(!1),n=()=>{t.value=!t.value};return(e,o)=>((0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("footer",{class:"footer"},[(0,s._)("p",{class:"footer-p"},[y,b,(0,s._)("a",{href:"javascript:void(0);",onClick:n,class:"footer-p-donate"},"donate")]),I]),((0,s.wg)(),(0,s.j4)(s.lR,{to:"body"},[(0,s.wy)((0,s.Wm)(w,{onCloseDonate:n},null,512),[[a.F8,t.value]])]))],64))}};const C=(0,h.Z)(k,[["__scopeId","data-v-30fbfef8"]]);var D=C;const S={class:"rich_content"};var M={__name:"App",setup(e){return(e,t)=>{const n=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)("div",S,[(0,s.Wm)(n),(0,s.Wm)(D)])}}};const x=M;var U=x,T=n(2483);function z(e,t,n,a,o,r){const i=(0,s.up)("Container"),l=(0,s.up)("upload-main");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(i),((0,s.wg)(),(0,s.j4)(l,{key:Math.random()}))],64)}var B=n(7139),O=n.p+"img/mascot.2e327e3b.svg";const Z=e=>((0,s.dD)("data-v-584ba1ae"),e=e(),(0,s.Cn)(),e),j={class:"container"},W={class:"container-zone"},N={class:"container-zone-page"},R=Z((()=>(0,s._)("img",{class:"container-zone-page-logo",src:O},null,-1))),E=Z((()=>(0,s._)("h1",{class:"container-zone-page-h1"},"FILE.SKI",-1))),F=Z((()=>(0,s._)("p",null,"Making Cooperation Easier. One Click Sharing, Always Smooth.",-1))),A={style:{display:"none"},class:"container-zone-page-notice"};function $(e,t,n,a,o,r){return(0,s.wg)(),(0,s.iD)("div",j,[(0,s._)("div",W,[(0,s._)("div",N,[R,E,F,(0,s._)("small",A,">>::  服务器连接状态：【已连接】.已为您自动分配上传通道："+(0,B.zw)(r.store.getters.getUserId)+"  ::<<",1)])])])}var P=n(65);const V=(e,t,a=null)=>{if(!n.g.window||!e)return;"string"!==typeof t&&(t=JSON.stringify(t));const s=n.g.window.localStorage;if(s.setItem(e,t),a&&!isNaN(parseInt(a))){const t=(new Date).getTime()/1e3;s.setItem(`${e}_expire`,t+a)}},q=e=>{if(!n.g.window||!e)return;const t=window.localStorage.getItem(e),a=window.localStorage.getItem(`${e}_expire`);if(a){const e=(new Date).getTime()/1e3;if(e>a)return}try{return JSON.parse(t)}catch(s){return t}};n(6229),n(7330),n(2062);var H=n(7773),L=n.n(H);const G={inArray(e,t){for(let n in t)if(t[n]===e)return!0;return!1},getRandomData(){return L()((new Date).getTime()+Math.random()+"")},getContentId(e){return L()(e)},arrayFormats(e,t){let n=e=>Object.prototype.toString.call(e).slice(8,-1),a=n(e);if("Array"===a)return e.map((e=>G.arrayFormats(e,t)));if("Object"===a){for(let n in e)e[n]=G.arrayFormats(e[n],t);return e}return void 0!==t[e+""]?t[e]:e},sendId(){let e=this.currentTime(),t=this.randomNumber(1e5,999999);return e+"-"+t},currentTime(){return(new Date).valueOf()},randomNumber(e,t){let n=0;switch(arguments.length){case 1:n=parseInt(Math.random()*e+1+"",10);break;case 2:n=parseInt(Math.random()*(t-e+1)+e,10);break;default:break}return n},bytesToSize:e=>{if(0===e)return"0 B";let t=1e3,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(t));return(e/Math.pow(t,a)).toPrecision(3)+" "+n[a]},dateFormat:(e,t)=>{const n=e=>{let t=e.getFullYear()+"年",n=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"月",a=(e.getDate()<10?"0"+e.getDate():e.getDate())+"日";return t+n+a};let a=new Date(e).toJSON(),s=new Date(+new Date(a)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,""),o=new Date(Date.parse(s.replace(/-/g,"/")));return n(o)},getLastSegmentFromUrl:e=>{const t=new URL(e),n=t.pathname.split("/");let a="";for(let s=n.length-1;s>=0;s--)if(""!==n[s].trim()){a=n[s];break}return a}};var J=(0,P.MT)({state:{isConnect:!1,isComplete:!1,shareUrl:"",userId:""!==q("userId")?q("userId"):"",errorMsg:""},getters:{getIsConnect(e){return e.isConnect},getIsComplete(e){return e.isComplete},getUserId(e){return e.userId},getShareUrl(e){return e.shareUrl},getErrorMsg(e){return e.errorMsg}},mutations:{setIsConnectMutation:(e,t)=>{e.isConnect=t},setIsCompleteMutation:(e,t)=>{e.isComplete=t},setUserIdMutation:(e,t)=>{V("userId",t),e.userId=t},setShareUrlMutation:(e,t)=>{e.shareUrl=t},setErrorMsgMutation:(e,t)=>{e.errorMsg=t}},actions:{setIsConnectAction({commit:e},t){e("setIsConnectMutation",t)},setIsCompleteAction({commit:e},t){e("setIsCompleteMutation",t)},setUserIdAction({commit:e},t){e("setUserIdMutation",t)},setShareUrlAction:({commit:e},t)=>{e("setShareUrlMutation",t)},setErrorMsgAction:({commit:e},t)=>{e("setErrorMsgMutation",t)}},modules:{}}),K={name:"Container",computed:{store(){return J}}};const Y=(0,h.Z)(K,[["render",$],["__scopeId","data-v-584ba1ae"]]);var Q=Y,X=n(273),ee=n.n(X);const te={http:{url:"https://file.ski:82/"},websocket:{url:"wss://file.ski:82/acc",reConnect:5},editor:null,content:"",apiKey:"R1dVc0ZaWWpNVU1ieWZWcGpJQmxOemUrOGxlcjRRamNqeVZjUjV2UGZ4YktBbC9rWW05cWcweTNGVUdqMXFrcVV5WUhEKzN4eVZlamViZWZDcTV5UFE9PQ==",editorKey:Math.random()},ne=new(ee());ne.config.baseURL=te.http.url,ne.interceptors.request.use((e=>(e.timeout=3e4,e.body["_t"]=(new Date).getTime(),e.headers={"content-type":"application/x-www-form-urlencoded"},e))),ne.interceptors.response.use((e=>Promise.resolve(e.data)),(e=>Promise.reject(e.response)));var ae=n(7327);class se{constructor(){(0,ae.Z)(this,"ws",null),(0,ae.Z)(this,"callBackMapping",{}),(0,ae.Z)(this,"connected",!1),(0,ae.Z)(this,"sendRetryCount",0),(0,ae.Z)(this,"connectRetryCount",0)}static get Instance(){return this.instance||(this.instance=new se),this.instance}connect(e,t){if(!window.WebSocket)return console.log("您的浏览器不支持WebSocket");let n=te.websocket.url+"?userId="+e+"&platform=pc&type="+t;this.ws=new WebSocket(n),this.ws.onopen=()=>{this.connected=!0,this.connectRetryCount=0,this.loginSystem(e),setInterval(this.heartbeat,3e4)},this.ws.onclose=()=>{this.connected=!1,this.connectRetryCount++,J.dispatch("setErrorMsgAction","服务关闭啦").then((e=>{})),this.setStatus(!1,""),setTimeout((()=>{this.connect(e,t)}),500*this.connectRetryCount)},this.ws.onmessage=t=>{let n=JSON.parse(t.data);switch(n.Cmd){case"login":this.setStatus(!0,e);break;case"heartbeat":let t=!1;200==n.Response.code&&(t=!0),this.setStatus(t,n.Response.data.userId);break;case"enter":break;case"exit":break;case"msg":n.Response.code;break;case"complete":break;case"close":this.setStatus(!1,""),J.dispatch("setErrorMsgAction","服务关闭啦").then((e=>{}));break;default:}}}registerCallBack(e,t){this.callBackMapping[e]=t}unRegisterCallBack(e){this.callBackMapping[e]=null}setStatus(e,t){J.dispatch("setIsConnectAction",e).then((e=>{})),J.dispatch("setUserIdAction",t).then((e=>{}))}send(e){if(this.connected){this.sendRetryCount=0;try{this.ws.send(JSON.stringify(e))}catch(t){this.ws.send(e)}}else this.sendRetryCount++,setTimeout((()=>{this.send(e)}),500*this.sendRetryCount)}heartbeat(){let e='{"seq":"'+G.sendId()+'","cmd":"heartbeat","data":{}}';try{se.Instance.ws.send(e)}catch(t){se.Instance.ws.send(e)}}loginSystem(e){let t=this;const n={seq:G.sendId(),cmd:"login",data:{user_id:e,token:""}};t.send(n)}}(0,ae.Z)(se,"instance",null);var oe=n(7071),re=n(7024),ie=n(1417);const le={style:{color:"red",padding:"0px 5px"}};var ce={__name:"CountDown",props:{endTime:{type:Number,default:""},endText:{type:String,default:"文件已经销毁"}},setup(e){const t=e,n=(0,o.iH)(0),a=(0,o.iH)("");(0,s.YP)(n,((e,t)=>{r(n.value)})),(0,s.bv)((()=>{n.value=t.endTime,r(n.value)}));const r=e=>{let n=setInterval((function(){let s=new Date,o=new Date(1e3*e),r=o.getTime()-s.getTime();if(r>0){let e=Math.floor(r/864e5),t=Math.floor(r/36e5%24),n=Math.floor(r/6e4%60),s=Math.floor(r/1e3%60);t=t<10?"0"+t:t,n=n<10?"0"+n:n,s=s<10?"0"+s:s;let o="";e>0&&(o=`${e}天${t}小时${n}分${s}秒`),e<=0&&t>0&&(o=`${t}小时${n}分${s}秒`),e<=0&&t<=0&&(o=`${n}分${s}秒`),a.value=o}else clearInterval(n),a.value=t.endText}),1e3)};return(e,t)=>((0,s.wg)(),(0,s.iD)("span",le,[(0,s.WI)(e.$slots,"default",{},(()=>[(0,s.Uk)((0,B.zw)(a.value),1)]))]))}};const de=ce;var ue=de;const pe=e=>((0,s.dD)("data-v-7f3914ce"),e=e(),(0,s.Cn)(),e),me={class:"main"},ge={class:"main-upload"},fe={key:0,class:"main-upload-noStart"},he={key:1,class:"main-upload-noStart"},ve={key:2,class:"main-upload-process"},we={class:"main-upload-process-loading"},_e=pe((()=>(0,s._)("p",{class:"main-upload-process-loading__tips"},"Uploading:",-1))),ye={class:"main-upload-process-loading__row"},be={class:"main-upload-process-loading__row-progress"},Ie={class:"main-upload-process-loading__text"},ke={key:3,class:"main-upload-finished"},Ce={class:"main-upload-finished-fileName"},De={class:"main-upload-finished-fileInfo"},Se=pe((()=>(0,s._)("span",null,"Size: ",-1))),Me=pe((()=>(0,s._)("span",null," · ExpTime: ",-1))),xe={class:"main-upload-finished-tempLink"},Ue={class:"main-upload-finished-tempLink-urls"},Te={class:"main-upload-finished-tempLink-urls__url"},ze=["value"],Be=pe((()=>(0,s._)("div",{class:"main-upload-finished-tempLink-urls__tips"},[(0,s._)("span",null,"复制以上链接下载。文件有效期为24小时，请在有效期内下载，否则链接失效")],-1)));var Oe={__name:"UploadMain",setup(e){const t=(0,ie.RN)({}),{toClipboard:n}=(0,oe.Z)(),a=(0,o.iH)("noStart"),r=(0,o.qj)({progressText:"",fileName:"",fileSize:0,progressBar:"",fileInfo:{},shareUrl:"",toggleBtn:"暂停"});let i=null,l=!1;(0,s.wF)((()=>{ne.post("api/newConnect",{}).then((e=>{200==e.code&&(J.dispatch("setUserIdAction",e.data),se.Instance.connect(e.data,"login"))})).catch((e=>{J.dispatch("setErrorMsgAction",e.message)}))}));const c=()=>{document.getElementById("fileInput").click()},d=()=>{a.value="noStart",i=null,l=!1},u=e=>{const n=e.target.files[0];if(!n)return;if(!re.Gb)return void alert("This browser does not support uploads. Please use a modern browser instead.");r.fileName=n.name;const s="http://localhost:10000/files/";let o=1/0,c=1;const u={endpoint:s,chunkSize:o,retryDelays:[0,1e3,3e3,5e3],parallelUploads:c,metadata:{"Content-Type":"application/json",filename:n.name,filetype:n.type},headers:{Authorization:J.getters.getUserId},onError(e){t.error("文件过大，限制上传大小为1GB"),d()},onProgress(e,t){a.value="progress";const n=(e/t*100).toFixed(2);r.progressBar=`${n}%`,r.progressText=`Uploaded ${G.bytesToSize(e)} of ${G.bytesToSize(t)} (${n}%)`},onSuccess(e){ne.get("api/complete/"+G.getLastSegmentFromUrl(i.url),{}).then((e=>{200==e.code&&(r.fileInfo=e.data,a.value="finished",r.shareUrl=e.data.shareUrl)})).catch((e=>{d()}))}};i=new re.gq(n,u),i.findPreviousUploads().then((e=>{i.start(),l=!0}))},p=e=>{e.preventDefault(),i&&(l?(i.abort(),r.toggleBtn="继续",l=!1):(i.start(),r.toggleBtn="暂停",l=!0))},m=async()=>{try{await n(r.shareUrl).then((()=>{t.success("复制成功")})).catch((()=>{t.error("复制失败")}))}catch(e){}};return(e,t)=>((0,s.wg)(),(0,s.iD)("div",me,[(0,s._)("div",ge,["error"==a.value?((0,s.wg)(),(0,s.iD)("div",fe,"error")):(0,s.kq)("",!0),"noStart"==a.value?((0,s.wg)(),(0,s.iD)("div",he,[(0,s._)("button",{onClick:c},"select a file"),(0,s._)("input",{style:{display:"none"},type:"file",id:"fileInput",onChange:u},null,32)])):(0,s.kq)("",!0),"progress"==a.value?((0,s.wg)(),(0,s.iD)("div",ve,[(0,s._)("div",we,[_e,(0,s._)("div",ye,[(0,s._)("div",be,[(0,s._)("div",{class:"main-upload-process-loading__row-progress-bar",style:(0,B.j5)({width:r.progressBar})},null,4)]),(0,s._)("button",{onClick:p,class:"main-upload-process-loading__row-pause"},(0,B.zw)(r.toggleBtn),1)]),(0,s._)("p",Ie,(0,B.zw)(r.progressText),1)])])):(0,s.kq)("",!0),"finished"==a.value?((0,s.wg)(),(0,s.iD)("div",ke,[(0,s._)("p",Ce,(0,B.zw)(r.fileName),1),(0,s._)("p",De,[Se,(0,s._)("span",null,(0,B.zw)((0,o.SU)(G).bytesToSize(r.fileInfo.file_size)),1),Me,(0,s.Wm)(ue,{"end-time":r.fileInfo.expired_time},null,8,["end-time"])]),(0,s._)("div",xe,[(0,s._)("div",Ue,[(0,s._)("div",Te,[(0,s._)("input",{onClick:m,readonly:"",type:"text",value:r.shareUrl},null,8,ze)]),Be])])])):(0,s.kq)("",!0)])]))}};const Ze=(0,h.Z)(Oe,[["__scopeId","data-v-7f3914ce"]]);var je=Ze,We={name:"HomeView",components:{UploadMain:je,Container:Q}};const Ne=(0,h.Z)(We,[["render",z]]);var Re=Ne;const Ee={class:"rich_content home"};function Fe(e,t,n,a,o,r){const i=(0,s.up)("Container"),l=(0,s.up)("down-main");return(0,s.wg)(),(0,s.iD)("div",Ee,[(0,s.Wm)(i),(0,s.Wm)(l)])}const Ae=e=>((0,s.dD)("data-v-487df78a"),e=e(),(0,s.Cn)(),e),$e={class:"error"},Pe={class:"error-heading"},Ve=Ae((()=>(0,s._)("div",{class:"error-reload"},[(0,s._)("a",{href:"/"},"返回首页")],-1)));function qe(e,t,n,a,o,r){return(0,s.wg)(),(0,s.iD)("div",$e,[(0,s._)("div",Pe,(0,B.zw)(n.message),1),Ve])}var He={name:"Error",props:{message:{type:String,default:"404"}}};const Le=(0,h.Z)(He,[["render",qe],["__scopeId","data-v-487df78a"]]);var Ge=Le;const Je=e=>((0,s.dD)("data-v-48a9bd24"),e=e(),(0,s.Cn)(),e),Ke={class:"main"},Ye={key:0,class:"main-down"},Qe={class:"main-down-finished"},Xe={class:"main-down-finished-fileName"},et={class:"main-down-finished-fileInfo"},tt=Je((()=>(0,s._)("span",null,"Size: ",-1))),nt=Je((()=>(0,s._)("span",null," · Downloads: ",-1))),at=Je((()=>(0,s._)("span",null," · Views: ",-1))),st=Je((()=>(0,s._)("span",null," · Expiration time: ",-1))),ot=Je((()=>(0,s._)("div",{class:"line-t-40"},null,-1)));var rt={__name:"DownMain",setup(e){const t=(0,T.yj)(),n=(0,o.qj)({info:{},url:"",expireTime:0}),a=(0,o.iH)(!1),r=(0,o.iH)("");(0,s.wF)((()=>{let e=void 0!=t.params.code?t.params.code:"";ne.get("api/file/"+e,{}).then((e=>{200==e.code&&(n.info=e.data,n.url=e.data.url,n.expireTime=e.data.expire,a.value=!0)})).catch((e=>{a.value=!1,r.value=e.data.message}))}));const i=()=>{let e=document.createElement("a");e.download=n.info.file_name,e.style.display="none",e.href=n.url,document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(e,t)=>((0,s.wg)(),(0,s.iD)("div",Ke,[a.value?((0,s.wg)(),(0,s.iD)("div",Ye,[(0,s._)("div",Qe,[(0,s._)("p",Xe,(0,B.zw)(n.info.file_name),1),(0,s._)("p",et,[tt,(0,s._)("span",null,(0,B.zw)((0,o.SU)(G).bytesToSize(n.info.file_size)),1),nt,(0,s._)("span",null,(0,B.zw)(n.info.downloads),1),at,(0,s._)("span",null,(0,B.zw)(n.info.views),1),st,(0,s.Wm)(ue,{"end-time":n.expireTime},null,8,["end-time"])]),ot,(0,s._)("button",{onClick:i,class:"main-down-finished-download"},"Download")])])):((0,s.wg)(),(0,s.j4)(Ge,{key:1,message:r.value},null,8,["message"]))]))}};const it=(0,h.Z)(rt,[["__scopeId","data-v-48a9bd24"]]);var lt=it,ct={name:"DownView",components:{DownMain:lt,Container:Q}};const dt=(0,h.Z)(ct,[["render",Fe]]);var ut=dt;const pt=[{path:"/",name:"home",component:Re},{path:"/:code",name:"down",component:ut}],mt=(0,T.p7)({history:(0,T.PO)(),routes:pt});var gt=mt;(0,a.ri)(U).use(J).use(gt).mount("#app")}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,a,s,o){if(!a){var r=1/0;for(d=0;d<e.length;d++){a=e[d][0],s=e[d][1],o=e[d][2];for(var i=!0,l=0;l<a.length;l++)(!1&o||r>=o)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(i=!1,o<r&&(r=o));if(i){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,s,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p=""}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,o,r=a[0],i=a[1],l=a[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(l)var d=l(n)}for(t&&t(a);c<r.length;c++)o=r[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},a=self["webpackChunkgo_lan_file_front"]=self["webpackChunkgo_lan_file_front"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(6529)}));a=n.O(a)})();